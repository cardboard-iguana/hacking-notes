# Exploiting the Windows Scripting Host
The Windows Scripting Host (WSH) consists of two tools, `cscript.exe` for command-line scripts and `wscript.exe` for UI scripts, and executes Visual Basic scripts (though it doesn’t care about the extension). WSH operates with *regular user privileges*, not admin privileges.

An example VBScript:

```vb
Dim message                ' Create the variable `message`
message = "Welcome to THM" ' Set the variable `message`
MsgBox message             ' Display `message` using a pop-up dialog
```

Executing a program requires creating a “shell” object:

```vb
Set shell = WScript.CreateObject("Wscript.Shell")

' Note the space after calc.exe! This is required because of
' some weird interactions between wscript.exe/cscript.exe and
' the VB runtime. Alternately, TRIPLE double quotes can be
' used instead.
shell.Run("C:\Windows\System32\calc.exe " & WScript.ScriptFullName),0,True

' Alternate way to call calc.exe.
shell.Run("""C:\Windows\System32\calc.exe""" & WScript.ScriptFullName),0,True
```

It appears that recent versions of Windows may *severely* limit which binaries can be called from the `Wscript.Shell` object; `calc.exe` works, but pretty much nothing else does.

## Additional Resources
* [TryHackMe: Weaponization](https://tryhackme.com/room/weaponization)
